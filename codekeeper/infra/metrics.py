# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2015 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2015 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2015 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

import asyncio
import gc
import logging
import os
import time
import tracemalloc
from collections.abc import Callable
from contextlib import contextmanager
from dataclasses import dataclass, field
from datetime import datetime
from functools import wraps
from typing import Any

logger = logging.getLogger(__name__)


@dataclass
class OperationMetrics:
    operation_name: str
    call_count: int = 0
    total_duration_ms: float = 0.0
    min_duration_ms: float = float("inf")
    max_duration_ms: float = 0.0
    avg_duration_ms: float = 0.0
    p50_duration_ms: float = 0.0
    p95_duration_ms: float = 0.0
    p99_duration_ms: float = 0.0
    error_count: int = 0
    last_called: datetime | None = None
    duration_samples: list[float] = field(default_factory=list)

    def record(self, duration_ms: float, success: bool = True) -> None:
        self.call_count += 1
        self.total_duration_ms += duration_ms
        self.min_duration_ms = min(self.min_duration_ms, duration_ms)
        self.max_duration_ms = max(self.max_duration_ms, duration_ms)
        self.last_called = datetime.now()

        if len(self.duration_samples) < 1000:
            self.duration_samples.append(duration_ms)

        self._recalculate_stats()

        if not success:
            self.error_count += 1

    def _recalculate_stats(self) -> None:
        if self.call_count > 0:
            self.avg_duration_ms = self.total_duration_ms / self.call_count

        if len(self.duration_samples) > 1:
            sorted_samples = sorted(self.duration_samples)
            n = len(sorted_samples)

            self.p50_duration_ms = sorted_samples[int(n * 0.5)]
            self.p95_duration_ms = sorted_samples[int(n * 0.95)]
            self.p99_duration_ms = sorted_samples[int(n * 0.99)]
        elif len(self.duration_samples) == 1:
            self.p50_duration_ms = self.p95_duration_ms = self.p99_duration_ms = (
                self.duration_samples[0]
            )

    @property
    def success_rate(self) -> float:
        total = self.call_count
        if total == 0:
            return 0.0
        return (total - self.error_count) / total

    def to_dict(self) -> dict[str, Any]:
        return {
            "operation_name": self.operation_name,
            "call_count": self.call_count,
            "total_duration_ms": round(self.total_duration_ms, 2),
            "min_duration_ms": (
                round(self.min_duration_ms, 2) if self.min_duration_ms != float("inf") else 0
            ),
            "max_duration_ms": round(self.max_duration_ms, 2),
            "avg_duration_ms": round(self.avg_duration_ms, 2),
            "p50_duration_ms": round(self.p50_duration_ms, 2),
            "p95_duration_ms": round(self.p95_duration_ms, 2),
            "p99_duration_ms": round(self.p99_duration_ms, 2),
            "error_count": self.error_count,
            "success_rate": round(self.success_rate, 4),
            "last_called": self.last_called.isoformat() if self.last_called else None,
        }


class SystemMetrics:
    """System-level performance metrics."""

    def __init__(self):
        self._process = None
        self._last_cpu_times = None
        self._last_wall_time = None

    def get_memory_info(self) -> dict[str, Any]:
        """Get current memory usage information.

        Returns:
            Dictionary with memory metrics
        """
        try:
            import psutil

            process = psutil.Process(os.getpid())
            memory_info = process.memory_info()

            return {
                "rss_mb": round(memory_info.rss / 1024 / 1024, 2),
                "vms_mb": round(memory_info.vms / 1024 / 1024, 2),
                "percent": round(process.memory_percent(), 2),
            }
        except ImportError:
            current, peak = tracemalloc.get_traced_memory()
            gc.collect()
            return {
                "current_mb": round(current / 1024 / 1024, 2),
                "peak_mb": round(peak / 1024 / 1024, 2),
                "percent": 0.0,
            }

    def get_cpu_usage(self) -> dict[str, Any]:
        """Get CPU usage information.

        Returns:
            Dictionary with CPU metrics
        """
        try:
            import psutil

            process = psutil.Process(os.getpid())
            cpu_times = process.cpu_times()

            current_wall_time = time.time()
            current_cpu_times = cpu_times.user + cpu_times.system

            cpu_percent = process.cpu_percent(interval=0.1)

            if self._last_wall_time and self._last_cpu_times:
                wall_elapsed = current_wall_time - self._last_wall_time
                cpu_elapsed = current_cpu_times - self._last_cpu_times
                cpu_usage_percent = (cpu_elapsed / wall_elapsed) * 100 / os.cpu_count()
            else:
                cpu_usage_percent = cpu_percent

            self._last_wall_time = current_wall_time
            self._last_cpu_times = current_cpu_times

            return {
                "cpu_percent": round(cpu_usage_percent, 2),
                "user_time_sec": round(cpu_times.user, 2),
                "system_time_sec": round(cpu_times.system, 2),
            }
        except ImportError:
            return {
                "cpu_percent": 0.0,
                "user_time_sec": 0.0,
                "system_time_sec": 0.0,
            }

    def get_disk_io(self) -> dict[str, Any]:
        """Get disk I/O statistics.

        Returns:
            Dictionary with disk I/O metrics
        """
        try:
            import psutil

            disk_io = psutil.disk_io_counters()
            if disk_io:
                return {
                    "read_mb": round(disk_io.read_bytes / 1024 / 1024, 2),
                    "write_mb": round(disk_io.write_bytes / 1024 / 1024, 2),
                    "read_count": disk_io.read_count,
                    "write_count": disk_io.write_count,
                }
        except (ImportError, AttributeError):
            pass

        return {
            "read_mb": 0.0,
            "write_mb": 0.0,
            "read_count": 0,
            "write_count": 0,
        }

    def get_gc_stats(self) -> dict[str, Any]:
        """Get garbage collection statistics.

        Returns:
            Dictionary with GC metrics
        """
        gc_stats = gc.get_stats()
        return {
            "collections": sum(s["collections"] for s in gc_stats),
            "collected": sum(s["collected"] for s in gc_stats),
            "uncollectable": sum(s["uncollectable"] for s in gc_stats),
        }


class PerformanceMonitor:
    """Central performance monitoring component."""

    def __init__(self, enabled: bool = True):
        """Initialize the performance monitor.

        Args:
            enabled: Whether to enable metrics collection
        """
        self.enabled = enabled
        self._operation_metrics: dict[str, OperationMetrics] = {}
        self._system_metrics = SystemMetrics()
        self._request_start_times: dict[str, float] = {}

    def get_operation_metric(self, operation_name: str) -> OperationMetrics:
        """Get or create an operation metric.

        Args:
            operation_name: Name of the operation

        Returns:
            OperationMetrics instance
        """
        if operation_name not in self._operation_metrics:
            self._operation_metrics[operation_name] = OperationMetrics(
                operation_name=operation_name
            )
        return self._operation_metrics[operation_name]

    def record_operation(
            self,
            operation_name: str,
            duration_ms: float,
            success: bool = True,
    ) -> None:
        """Record a single operation.

        Args:
            operation_name: Name of the operation
            duration_ms: Duration in milliseconds
            success: Whether the operation succeeded
        """
        if not self.enabled:
            return

        metric = self.get_operation_metric(operation_name)
        metric.record(duration_ms, success)

    @contextmanager
    def measure_operation(self, operation_name: str, success_on_error: bool = False):
        """Context manager to measure operation duration.

        Args:
            operation_name: Name of the operation
            success_on_error: Whether to count errors as successful

        Yields:
            None
        """
        start_time = time.time()
        try:
            yield
            success = True
        except Exception:
            success = success_on_error
            raise
        finally:
            duration_ms = (time.time() - start_time) * 1000
            self.record_operation(operation_name, duration_ms, success)

    def track_operation(self, operation_name: str) -> Callable:
        """Decorator to track function execution time.

        Args:
            operation_name: Name for the tracked operation

        Returns:
            Decorator function
        """

        def decorator(func: Callable) -> Callable:
            @wraps(func)
            async def async_wrapper(*args, **kwargs):
                start_time = time.time()
                try:
                    result = await func(*args, **kwargs)
                    duration_ms = (time.time() - start_time) * 1000
                    self.record_operation(operation_name, duration_ms, True)
                    return result
                except Exception:
                    duration_ms = (time.time() - start_time) * 1000
                    self.record_operation(operation_name, duration_ms, False)
                    raise

            @wraps(func)
            def sync_wrapper(*args, **kwargs):
                start_time = time.time()
                try:
                    result = func(*args, **kwargs)
                    duration_ms = (time.time() - start_time) * 1000
                    self.record_operation(operation_name, duration_ms, True)
                    return result
                except Exception:
                    duration_ms = (time.time() - start_time) * 1000
                    self.record_operation(operation_name, duration_ms, False)
                    raise

            if asyncio.iscoroutinefunction(func):
                return async_wrapper
            return sync_wrapper

        return decorator

    def start_request(self, request_id: str) -> None:
        """Start tracking a request.

        Args:
            request_id: Unique request identifier
        """
        self._request_start_times[request_id] = time.time()

    def end_request(self, request_id: str) -> float:
        """End tracking a request and return duration.

        Args:
            request_id: Unique request identifier

        Returns:
            Duration in milliseconds
        """
        if request_id not in self._request_start_times:
            return 0.0

        duration_ms = (time.time() - self._request_start_times[request_id]) * 1000
        del self._request_start_times[request_id]
        return duration_ms

    def get_all_operation_metrics(self) -> list[dict[str, Any]]:
        """Get all operation metrics.

        Returns:
            List of operation metric dictionaries
        """
        return [metric.to_dict() for metric in self._operation_metrics.values()]

    def get_system_metrics(self) -> dict[str, Any]:
        """Get current system metrics.

        Returns:
            Dictionary with system metrics
        """
        return {
            "memory": self._system_metrics.get_memory_info(),
            "cpu": self._system_metrics.get_cpu_usage(),
            "disk_io": self._system_metrics.get_disk_io(),
            "gc": self._system_metrics.get_gc_stats(),
        }

    def get_summary(self) -> dict[str, Any]:
        """Get a complete performance summary.

        Returns:
            Dictionary with all performance metrics
        """
        return {
            "operations": self.get_all_operation_metrics(),
            "system": self.get_system_metrics(),
            "total_operations": sum(m.call_count for m in self._operation_metrics.values()),
            "total_errors": sum(m.error_count for m in self._operation_metrics.values()),
        }

    def reset(self) -> None:
        """Reset all metrics."""
        self._operation_metrics.clear()
        self._request_start_times.clear()
        logger.info("Performance metrics reset")


_default_monitor: PerformanceMonitor | None = None


def get_monitor(enabled: bool = True) -> PerformanceMonitor:
    """Get the global performance monitor instance.

    Args:
        enabled: Whether to enable the monitor

    Returns:
        PerformanceMonitor instance
    """
    global _default_monitor
    if _default_monitor is None:
        _default_monitor = PerformanceMonitor(enabled=enabled)
    elif enabled and not _default_monitor.enabled:
        _default_monitor.enabled = True
    return _default_monitor


@contextmanager
def monitor_operation(operation_name: str, monitor: PerformanceMonitor | None = None):
    """Convenience context manager for operation monitoring.

    Args:
        operation_name: Name of the operation
        monitor: Performance monitor instance (uses global if None)
    """
    if monitor is None:
        monitor = get_monitor()

    with monitor.measure_operation(operation_name):
        yield


def track_operation(operation_name: str, monitor: PerformanceMonitor | None = None):
    """Convenience decorator for operation tracking.

    Args:
        operation_name: Name for the tracked operation
        monitor: Performance monitor instance (uses global if None)
    """
    if monitor is None:
        monitor = get_monitor()

    return monitor.track_operation(operation_name)
