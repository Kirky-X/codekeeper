# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2015 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2015 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2015 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.

import re
from pathlib import Path

from codekeeper.languages.base import (
    ClassInfo,
    CommentStyle,
    CopyrightPosition,
    FunctionInfo,
    ILanguageHandler,
)


class TypeScriptHandler(ILanguageHandler):
    SUPPORTED_EXTENSIONS = [".ts", ".tsx", ".js", ".jsx", ".mjs"]

    FUNC_PATTERN = re.compile(
        r"^(?P<indent>\s*)"
        r"(?P<async>async\s+)?"
        r"function\s+"
        r"(?P<name>\w+)\s*"
        r"\((?P<params>(?:[^()]+|\([^)]*\))*)\)"
        r"(?:\s*:\s*(?P<return_type>[^{]+))?\s*\{",
        re.MULTILINE,
    )

    ARROW_FUNC_PATTERN = re.compile(
        r"^(?P<indent>\s*)(?:async\s+)?"
        r"(?P<params>\([^)]*\)|[\w$]+(?:\s*,\s*[\w$]+)*)\s*"
        r"(?:\s*:\s*(?P<type_params>[^{]+))?\s*=>",
        re.MULTILINE,
    )

    CLASS_PATTERN = re.compile(
        r"^(?P<indent>\s*)class\s+"
        r"(?P<name>\w+)"
        r"(?:\s+extends\s+[\w.$]+)?"
        r"(?:\s+implements\s+[\w.,\s$]+)?\s*\{",
        re.MULTILINE,
    )

    INTERFACE_PATTERN = re.compile(
        r"^(?P<indent>\s*)interface\s+(?P<name>\w+)"
        r"(?:\s+extends\s+[\w.,\s]+)?\s*\{",
        re.MULTILINE,
    )

    TYPE_PATTERN = re.compile(
        r"^(?P<indent>\s*)type\s+(?P<name>\w+)\s*=\s*\{",
        re.MULTILINE,
    )

    METHOD_PATTERN = re.compile(
        r"^(?P<indent>\s*)(?P<async>async\s+)?"
        r"(?P<name>\w+)\s*"
        r"\((?P<params>(?:[^()]+|\([^)]*\))*)\)"
        r"(?:\s*:\s*(?P<return_type>[^{]+))?\s*\{",
        re.MULTILINE,
    )

    COMMENT_PATTERN = re.compile(r"//\s*(.*)$", re.MULTILINE)

    @property
    def extensions(self) -> list[str]:
        return self.SUPPORTED_EXTENSIONS

    def __init__(self, content: str = "", file_path: Path | None = None):
        self._content = content
        self._file_path = file_path

    @classmethod
    def from_file(cls, file_path: Path | str) -> "TypeScriptHandler":
        path = Path(file_path) if isinstance(file_path, str) else file_path
        content = path.read_text(encoding="utf-8")
        return cls(content=content, file_path=path)

    def get_functions(self) -> list[FunctionInfo]:
        if self._content:
            file_path = self._file_path if self._file_path else Path(".")
            functions = self._parse_functions(self._content, file_path)
            classes = self._parse_classes(self._content, file_path)
            for cls in classes:
                functions.extend(cls.methods)
            return functions
        return []

    def get_classes(self) -> list[ClassInfo]:
        if self._content:
            file_path = self._file_path if self._file_path else Path(".")
            classes = []
            classes.extend(self._parse_classes(self._content, file_path))
            classes.extend(self._parse_interfaces(self._content, file_path))
            classes.extend(self._parse_types(self._content, file_path))
            return classes
        return []

    def get_copyright_header(self) -> dict | None:
        if self.has_copyright(self._content):
            return {"detected": True, "style": self.get_comment_style()}
        return None

    def get_comment_style(self) -> CommentStyle:
        return CommentStyle.SINGLE_LINE

    def get_copyright_position(self) -> CopyrightPosition:
        return CopyrightPosition.FILE_TOP

    def has_copyright(self, content: str) -> bool:
        copyright_patterns = [
            "Copyright",
            "SPDX-License-Identifier",
            "license",
            "Licensed under the MIT",
        ]
        return any(pattern in content for pattern in copyright_patterns)

    def get_copyright_template(
            self,
            license: str,
            author: str | None = None,
            year_range: str | None = None,
    ) -> str:
        lines = [
            f"// Copyright (c) {year_range or '2025'} {author or 'Author'}. All rights reserved.",
            f"// Licensed under the {license} License.",
            "// See LICENSE file in the project root for full license information.",
        ]
        return "\n".join(lines)

    def insert_copyright(
            self,
            content: str,
            license: str,
            author: str | None = None,
            year_range: str | None = None,
            position: CopyrightPosition | None = None,
    ) -> str:
        if position is None:
            position = self.get_copyright_position()

        template = self.get_copyright_template(license, author, year_range)

        if position == CopyrightPosition.FILE_TOP:
            return template + "\n\n" + content

        lines = content.split("\n")

        if lines and (lines[0].startswith("//") or lines[0].startswith("/**")):
            doc_end = 0
            for i, line in enumerate(lines):
                if line.strip() and not line.strip().startswith("//"):
                    doc_end = i
                    break
            return (
                    "\n".join(lines[:doc_end]) + "\n\n" + template + "\n\n" + "\n".join(lines[doc_end:])
            )

        return template + "\n\n" + content

    def _find_matching_brace(self, content: str, start_pos: int) -> int:
        depth = 0
        in_string = False
        in_template = False
        escaped = False

        i = start_pos
        while i < len(content):
            char = content[i]

            if escaped:
                escaped = False
                i += 1
                continue

            if char == "\\":
                escaped = True
                i += 1
                continue

            if char == "`" and not in_string:
                in_template = not in_template
            elif char == '"' and not in_template:
                in_string = not in_string
            elif not in_string and not in_template:
                if char == "{":
                    depth += 1
                elif char == "}":
                    depth -= 1
                    if depth == 0:
                        return i

            i += 1

        return start_pos

    def _get_docstring(self, content: str, start_line: int) -> str | None:
        lines = content.split("\n")
        if start_line > len(lines):
            return None

        doc_lines = []
        for i in range(start_line - 2, -1, -1):
            if i < 0:
                break
            line = lines[i]
            match = re.match(r"//\s*(.*)$", line)
            if match:
                doc_lines.insert(0, match.group(1).strip())
            elif line.strip() and not line.strip().startswith("//"):
                break

        return "\n".join(doc_lines) if doc_lines else None

    def _parse_function_params(self, params_str: str) -> list[str]:
        if not params_str.strip():
            return []

        params = []
        current_param = ""
        paren_depth = 0
        bracket_depth = 0

        for char in params_str:
            if char == "(":
                paren_depth += 1
                current_param += char
            elif char == ")":
                paren_depth -= 1
                current_param += char
            elif char == "[":
                bracket_depth += 1
                current_param += char
            elif char == "]":
                bracket_depth -= 1
                current_param += char
            elif char == "," and paren_depth == 0 and bracket_depth == 0:
                if current_param.strip():
                    params.append(current_param.strip())
                current_param = ""
            else:
                current_param += char

        if current_param.strip():
            params.append(current_param.strip())

        return params

    def _parse_function(
            self, match: re.Match, content: str, file_path: Path, is_arrow: bool = False
    ) -> FunctionInfo | None:
        name = match.group("name")
        params_str = match.group("params")
        return_type = match.group("return_type")
        async_match = match.group("async")

        if is_arrow:
            name = f"arrow_{name}" if name and not params_str.startswith("(") else "anonymous"

        start_line = content[: match.start()].count("\n") + 1

        brace_pos = content.find("{", match.start())
        if brace_pos == -1:
            return None

        brace_end = self._find_matching_brace(content, brace_pos)
        end_line = content[:brace_end].count("\n") + 1

        params = self._parse_function_params(params_str)
        docstring = self._get_docstring(content, start_line)

        return_type_str = None
        if return_type:
            return_type_str = return_type.strip()

        decorators = []
        if async_match:
            decorators.append("async")

        return FunctionInfo(
            name=name,
            file_path=file_path,
            start_line=start_line,
            end_line=end_line,
            parameters=params,
            decorators=decorators,
            docstring=docstring,
            return_type=return_type_str,
        )

    def _parse_class(self, match: re.Match, content: str, file_path: Path) -> ClassInfo:
        name = match.group("name")

        start_line = content[: match.start()].count("\n") + 1

        brace_pos = content.find("{", match.start())
        if brace_pos == -1:
            return ClassInfo(
                name=name,
                file_path=file_path,
                start_line=start_line,
                end_line=start_line,
                methods=[],
                docstring=None,
                decorators=[],
            )

        brace_end = self._find_matching_brace(content, brace_pos)
        end_line = content[:brace_end].count("\n") + 1

        class_content = content[brace_pos + 1: brace_end]
        methods = self._parse_methods_in_class(class_content, content, file_path, start_line)

        docstring = self._get_docstring(content, start_line)

        return ClassInfo(
            name=name,
            file_path=file_path,
            start_line=start_line,
            end_line=end_line,
            methods=methods,
            docstring=docstring,
            decorators=["class"],
        )

    def _parse_interface(self, match: re.Match, content: str, file_path: Path) -> ClassInfo:
        name = match.group("name")

        start_line = content[: match.start()].count("\n") + 1

        brace_pos = content.find("{", match.start())
        if brace_pos == -1:
            return ClassInfo(
                name=name,
                file_path=file_path,
                start_line=start_line,
                end_line=start_line,
                methods=[],
                docstring=None,
                decorators=[],
            )

        brace_end = self._find_matching_brace(content, brace_pos)
        end_line = content[:brace_end].count("\n") + 1

        interface_content = content[brace_pos + 1: brace_end]
        methods = self._parse_methods_in_interface(interface_content, content, file_path, start_line)

        docstring = self._get_docstring(content, start_line)

        return ClassInfo(
            name=name,
            file_path=file_path,
            start_line=start_line,
            end_line=end_line,
            methods=methods,
            docstring=docstring,
            decorators=["interface"],
        )

    def _parse_type(self, match: re.Match, content: str, file_path: Path) -> ClassInfo:
        name = match.group("name")

        start_line = content[: match.start()].count("\n") + 1

        brace_pos = content.find("{", match.start())
        if brace_pos == -1:
            return ClassInfo(
                name=name,
                file_path=file_path,
                start_line=start_line,
                end_line=start_line,
                methods=[],
                docstring=None,
                decorators=[],
            )

        brace_end = self._find_matching_brace(content, brace_pos)
        end_line = content[:brace_end].count("\n") + 1

        docstring = self._get_docstring(content, start_line)

        return ClassInfo(
            name=name,
            file_path=file_path,
            start_line=start_line,
            end_line=end_line,
            methods=[],
            docstring=docstring,
            decorators=["type"],
        )

    def _parse_methods_in_class(
            self, class_content: str, full_content: str, file_path: Path, _base_line: int
    ) -> list[FunctionInfo]:
        methods = []
        class_lines = class_content.split("\n")

        for line in class_lines:
            method_match = self.METHOD_PATTERN.match(line)
            if method_match:
                full_line_start = full_content.find(line)
                if full_line_start != -1:
                    parsed = self._parse_function(method_match, full_content, file_path)
                    if parsed:
                        methods.append(parsed)

        return methods

    def _parse_methods_in_interface(
            self, interface_content: str, full_content: str, file_path: Path, _base_line: int
    ) -> list[FunctionInfo]:
        methods = []
        interface_lines = interface_content.split("\n")

        for line in interface_lines:
            method_match = self.METHOD_PATTERN.match(line)
            if method_match:
                full_line_start = full_content.find(line)
                if full_line_start != -1:
                    parsed = self._parse_function(method_match, full_content, file_path)
                    if parsed:
                        methods.append(parsed)

        return methods

    def _parse_functions(self, content: str, file_path: Path) -> list[FunctionInfo]:
        functions = []

        for match in self.FUNC_PATTERN.finditer(content):
            parsed = self._parse_function(match, content, file_path)
            if parsed:
                functions.append(parsed)

        return functions

    def _parse_classes(self, content: str, file_path: Path) -> list[ClassInfo]:
        classes = []
        for match in self.CLASS_PATTERN.finditer(content):
            parsed = self._parse_class(match, content, file_path)
            if parsed:
                classes.append(parsed)
        return classes

    def _parse_interfaces(self, content: str, file_path: Path) -> list[ClassInfo]:
        interfaces = []
        for match in self.INTERFACE_PATTERN.finditer(content):
            parsed = self._parse_interface(match, content, file_path)
            if parsed:
                interfaces.append(parsed)
        return interfaces

    def _parse_types(self, content: str, file_path: Path) -> list[ClassInfo]:
        types = []
        for match in self.TYPE_PATTERN.finditer(content):
            parsed = self._parse_type(match, content, file_path)
            if parsed:
                types.append(parsed)
        return types

    def parse_functions(self, content: str, file_path: Path) -> list[FunctionInfo]:
        return self._parse_functions(content, file_path)

    def parse_classes(self, content: str, file_path: Path) -> list[ClassInfo]:
        classes = []
        classes.extend(self._parse_classes(content, file_path))
        classes.extend(self._parse_interfaces(content, file_path))
        classes.extend(self._parse_types(content, file_path))
        return classes

    def parse_all(
            self, content: str, file_path: Path
    ) -> tuple[list[FunctionInfo], list[ClassInfo]]:
        functions = self._parse_functions(content, file_path)
        classes = []
        classes.extend(self._parse_classes(content, file_path))
        classes.extend(self._parse_interfaces(content, file_path))
        classes.extend(self._parse_types(content, file_path))
        return functions, classes
