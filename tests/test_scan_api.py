"""
File Scanning API Tests

测试文件扫描相关API
"""

# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2015 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2015 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the INVALID-LICENSE-TYPE License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author.With.Dots. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author_With_Underscore. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author-With-Hyphen. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author with spaces. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2015 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2020-2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test_Author123. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Organization Name. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author <email@example.com>. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the GPL-3.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the BSD-3-Clause License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the Apache-2.0 License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2025 Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


# Copyright (c) 2024-2025 Test Author. All rights reserved.
# Licensed under the MIT License.
# See LICENSE file in the project root for full license information.


import pytest
from pathlib import Path
from tests.api_test_framework import (
    CodeKeeperApiTestFramework,
    HttpMethod,
    TestStatus
)


class TestFileScanning:
    """文件扫描API测试类"""

    @pytest.fixture(autouse=True)
    def setup(self):
        self.framework = CodeKeeperApiTestFramework()
        self.test_dir = self.framework.test_files_dir

        (self.test_dir / "test_file1.py").write_text("def test(): pass")
        (self.test_dir / "test_file2.rs").write_text("fn test() {}")
        (self.test_dir / "test_file3.java").write_text("class Test {}")

        subdir = self.test_dir / "subdir"
        subdir.mkdir(exist_ok=True)
        (subdir / "nested_file.go").write_text("package main")

        yield
        self.framework.cleanup_test_files()

    def test_scan_recursive_success(self):
        """测试递归扫描成功"""
        self.framework.register_test_case(
            name="Scan Recursive - Success",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Successfully scan files recursively",
            expected_status=200,
            request_params={"recursive": True},
            priority="high",
            tags=["scan", "recursive", "positive"]
        )

        results = self.framework.run_tests(filter_tags=["recursive", "positive"])
        assert len(results) == 1
        assert results[0].status == TestStatus.PASS

    def test_scan_non_recursive(self):
        """测试非递归扫描"""
        self.framework.register_test_case(
            name="Scan Non-recursive",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Scan files non-recursively",
            expected_status=200,
            request_params={"recursive": False},
            priority="high",
            tags=["scan", "non_recursive"]
        )

        results = self.framework.run_tests(filter_tags=["non_recursive"])
        assert len(results) == 1
        assert results[0].status == TestStatus.PASS

    def test_scan_response_format(self):
        """测试扫描响应格式"""
        self.framework.register_test_case(
            name="Scan - Response Format",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Verify scan response format",
            expected_status=200,
            request_params={"recursive": True},
            priority="high",
            tags=["scan", "validation"]
        )

        results = self.framework.run_tests(filter_tags=["validation"])
        assert len(results) == 1
        assert results[0].response_data is not None
        assert "success" in results[0].response_data
        assert "files" in results[0].response_data or "files_found" in results[0].response_data

    def test_scan_multiple_extensions(self):
        """测试扫描多种文件类型"""
        extensions = [".py", ".rs", ".java", ".go", ".cpp", ".ts"]

        for ext in extensions:
            self.framework.register_test_case(
                name=f"Scan - Extension {ext}",
                method=HttpMethod.GET,
                endpoint="scan",
                description=f"Scan files with {ext} extension",
                expected_status=200,
                request_params={"recursive": True},
                priority="medium",
                tags=["scan", "extensions", ext]
            )

        results = self.framework.run_tests(filter_tags=["extensions"])
        assert len(results) == len(extensions)


class TestScanningEdgeCases:
    """扫描API边界值测试"""

    @pytest.fixture(autouse=True)
    def setup(self):
        self.framework = CodeKeeperApiTestFramework()
        yield
        self.framework.cleanup_test_files()

    def test_scan_empty_directory(self):
        """测试空目录扫描"""
        empty_dir = self.framework.root_dir / "temp" / "empty_scan"
        empty_dir.mkdir(parents=True, exist_ok=True)

        self.framework.register_test_case(
            name="Scan - Empty Directory",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Scan empty directory",
            expected_status=200,
            request_params={"recursive": True},
            priority="medium",
            tags=["scan", "boundary", "empty"]
        )

        results = self.framework.run_tests(filter_tags=["empty"])
        assert len(results) == 1

    def test_scan_deep_directory_structure(self):
        """测试深层目录结构扫描"""
        deep_path = self.framework.root_dir / "temp" / "deep"
        current = deep_path
        for i in range(5):
            current = current / f"level_{i}"
            current.mkdir(parents=True, exist_ok=True)
            (current / f"file_{i}.py").write_text(f"# Level {i}")

        self.framework.register_test_case(
            name="Scan - Deep Structure",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Scan deeply nested directory structure",
            expected_status=200,
            request_params={"recursive": True},
            priority="medium",
            tags=["scan", "boundary", "deep"]
        )

        results = self.framework.run_tests(filter_tags=["deep"])
        assert len(results) == 1

    def test_scan_large_files(self):
        """测试扫描大文件"""
        large_file = self.framework.root_dir / "temp" / "large_file.py"
        content = "# Large file\n" * 10000
        large_file.write_text(content)

        self.framework.register_test_case(
            name="Scan - Large Files",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Scan directory with large files",
            expected_status=200,
            request_params={"recursive": True},
            priority="low",
            tags=["scan", "boundary", "large_file"]
        )

        results = self.framework.run_tests(filter_tags=["large_file"])
        assert len(results) == 1

    def test_scan_mixed_content(self):
        """测试扫描混合内容目录"""
        mixed_dir = self.framework.root_dir / "temp" / "mixed"
        mixed_dir.mkdir(parents=True, exist_ok=True)

        (mixed_dir / "code.py").write_text("def hello(): pass")
        (mixed_dir / "readme.txt").write_text("This is a readme")
        (mixed_dir / "data.json").write_text('{"key": "value"}')
        (mixed_dir / "config.yaml").write_text("key: value")

        self.framework.register_test_case(
            name="Scan - Mixed Content",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Scan directory with mixed file types",
            expected_status=200,
            request_params={"recursive": True},
            priority="medium",
            tags=["scan", "mixed"]
        )

        results = self.framework.run_tests(filter_tags=["mixed"])
        assert len(results) == 1

    def test_scan_only_code_files(self):
        """测试只扫描代码文件"""
        code_dir = self.framework.root_dir / "temp" / "code_only"
        code_dir.mkdir(parents=True, exist_ok=True)

        (code_dir / "script.py").write_text("# Python file")
        (code_dir / "module.rs").write_text("// Rust file")
        (code_dir / "class.java").write_text("// Java file")
        (code_dir / "not_code.md").write_text("# Markdown file")

        self.framework.register_test_case(
            name="Scan - Code Files Only",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Scan for code files only",
            expected_status=200,
            request_params={"recursive": True},
            priority="medium",
            tags=["scan", "filter"]
        )

        results = self.framework.run_tests(filter_tags=["filter"])
        assert len(results) == 1


class TestScanningPerformance:
    """扫描性能测试"""

    @pytest.fixture(autouse=True)
    def setup(self):
        self.framework = CodeKeeperApiTestFramework()
        yield
        self.framework.cleanup_test_files()

    def test_scan_many_files(self):
        """测试扫描大量文件"""
        many_dir = self.framework.root_dir / "temp" / "many_files"
        many_dir.mkdir(parents=True, exist_ok=True)

        for i in range(100):
            ext = [".py", ".rs", ".java", ".go"][i % 4]
            (many_dir / f"file_{i}{ext}").write_text(f"# File {i}")

        self.framework.register_test_case(
            name="Scan - Many Files",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Scan directory with many files",
            expected_status=200,
            request_params={"recursive": True},
            priority="low",
            tags=["scan", "performance", "many_files"]
        )

        results = self.framework.run_tests(filter_tags=["many_files"])
        assert len(results) == 1
        assert results[0].execution_time > 0

    def test_scan_execution_time(self):
        """测试扫描执行时间"""
        self.framework.register_test_case(
            name="Scan - Execution Time",
            method=HttpMethod.GET,
            endpoint="scan",
            description="Measure scan execution time",
            expected_status=200,
            request_params={"recursive": True},
            priority="low",
            tags=["scan", "performance", "timing"]
        )

        results = self.framework.run_tests(filter_tags=["timing"])
        assert len(results) == 1
        assert results[0].execution_time >= 0


if __name__ == "__main__":
    pytest.main([__file__, "-v"])
